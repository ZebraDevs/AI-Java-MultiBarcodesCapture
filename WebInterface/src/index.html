<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode WMS - Zebra Technologies</title>
    <link rel="stylesheet" href="css/wms-style.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📦</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <h1>
            <span>📦</span>
            Barcode Warehouse Management System
        </h1>
        <div class="subtitle">Zebra Technologies - AI MultiBarcode Capture Interface</div>
        <button id="btn-settings" class="settings-button" title="Settings">
            ⚙️
        </button>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <button id="btn-sessions" class="nav-button active">
            📋 Capture Sessions
        </button>
        <button id="btn-refresh" class="nav-button">
            🔄 Refresh
        </button>
        <div style="margin-left: auto; color: #6c757d; font-size: 0.9rem;">
            <span id="last-updated">Last updated: Never</span>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div id="main-content">
            <!-- Content will be dynamically loaded here -->
            <div class="loading">
                <div class="spinner"></div>
                <p>Initializing WMS...</p>
            </div>
        </div>
    </div>

    <!-- Endpoint Modal -->
    <div id="endpoint-modal" class="modal hide">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🔗 API Endpoint Configuration</h2>
                <button class="modal-close" onclick="app.closeEndpointModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Use these endpoints to configure your Android AI MultiBarcode Capture application:</p>

                <div class="endpoint-section">
                    <h3>🏠 Local Network Endpoint</h3>
                    <div class="endpoint-box">
                        <input type="text" id="local-endpoint" readonly>
                        <button onclick="app.copyToClipboard('local-endpoint')" class="copy-btn">📋 Copy</button>
                        <button onclick="app.showQRCode('local-endpoint')" class="qr-btn">📱 QR Code</button>
                    </div>
                    <small>Use this endpoint when both the Android device and this server are on the same local network.</small>
                </div>

                <div class="endpoint-section">
                    <h3>🌐 Internet Endpoint</h3>
                    <div class="endpoint-box">
                        <input type="text" id="internet-endpoint" readonly>
                        <button onclick="app.copyToClipboard('internet-endpoint')" class="copy-btn">📋 Copy</button>
                        <button onclick="app.showQRCode('internet-endpoint')" class="qr-btn">📱 QR Code</button>
                    </div>
                    <small>Use this endpoint when accessing the server from the internet (requires port forwarding or public hosting).</small>
                </div>

                <div class="endpoint-help">
                    <h4>📱 Android App Configuration:</h4>
                    <ol>
                        <li>Open the AI MultiBarcode Capture app</li>
                        <li>Go to Settings → Server Configuration</li>
                        <li>Paste one of the endpoints above</li>
                        <li>Test the connection and save</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Modal -->
    <div id="qr-modal" class="modal hide">
        <div class="modal-content qr-modal-content">
            <div class="modal-header">
                <h2>📱 QR Code - Endpoint URL</h2>
                <button class="modal-close" onclick="app.closeQRModal()">&times;</button>
            </div>
            <div class="modal-body qr-modal-body">
                <div class="qr-container">
                    <div id="qr-code-display"></div>
                </div>
                <div class="qr-info">
                    <p><strong>Endpoint URL:</strong></p>
                    <div class="qr-url" id="qr-url-text"></div>
                    <p class="qr-instructions">Scan this QR code with your Android AI MultiBarcode Capture app to automatically configure the endpoint.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hide">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" onclick="app.closeSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Configuration Section -->
                <div class="settings-section">
                    <h3 class="section-title">⚙️ Configuration</h3>
                    <div class="section-content">
                        <p class="section-description">Configure endpoint settings and connection parameters</p>
                        <button id="settings-btn-endpoint" class="btn btn-primary">
                            🔗 Endpoint Configuration
                        </button>
                    </div>
                </div>

                <!-- Danger Zone Section -->
                <div class="settings-section danger-section">
                    <h3 class="section-title">⚠️ Danger Zone</h3>
                    <div class="section-content">
                        <p class="section-description">Irreversible actions that will permanently delete data</p>
                        <button id="settings-btn-reset" class="btn btn-danger">
                            🗑️ Erase All Data
                        </button>
                        <small class="danger-warning">⚠️ This action cannot be undone</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="text-align: center; padding: 2rem; color: #6c757d; font-size: 0.9rem;">
        <p>
            Barcode WMS &copy; 2024 - Powered by Zebra AI Vision SDK<br>
            <small>Connected to Android AI MultiBarcode Capture Application</small>
        </p>
    </footer>

    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>

    <!-- JavaScript -->
    <script src="js/wms-app.js?v=20250917131000"></script>

    <script>
        // Update last updated timestamp
        function updateLastUpdated() {
            const element = document.getElementById('last-updated');
            if (element) {
                element.textContent = 'Last updated: ' + new Date().toLocaleTimeString();
            }
        }

        // Update timestamp when app loads or refreshes
        document.addEventListener('DOMContentLoaded', () => {
            updateLastUpdated();

            // Update timestamp every minute
            setInterval(updateLastUpdated, 60000);
        });

        // Update timestamp when API calls complete
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
            return originalFetch.apply(this, args).then(response => {
                if (response.ok) {
                    updateLastUpdated();
                }
                return response;
            });
        };
    </script>
</body>
</html>